<html>
  <head>
    <title>Dashboard</title>
  </head>
  <body>
    <h1>Testing MQTT & Flask-SocketIO</h1>
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.1.2/socket.io.min.js"
    ></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>

    <script type="text/javascript">
      $(document).ready(function () {
        var socket = io.connect("http://127.0.0.1:5000/", {secure:false});

        var numbers_received = [];

        //receive details from server
        socket.on('newnumber', function(msg) {
          console.log("Received number" + msg.number);
          //maintain a list of ten numbers
          if (numbers_received.length >= 10){
              numbers_received.shift()
          }            
          console.log(msg.number);
          numbers_received.push(msg.number);
          numbers_string = '';
          for (var i = 0; i < numbers_received.length; i++){
              numbers_string = numbers_string + '<p>' + numbers_received[i].toString() + '</p>';
          }
          $('#log').html(numbers_string);
        });

        /*
        socket.emit('my event', "Page load completed");

        socket.on("connect", function (msg) {
          console.log('from connect:', msg);
        });

        socket.on("my response", function (msg) {
          console.log('from message: ', msg);
        });

        socket.on("error", function (msg) {
          console.log("from error", msg);
        }) */
      });
    </script>
  </body>
</html>
